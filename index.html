<!DOCTYPE html>
<html lang="en">
<head>
<title>Test WASM</title>
</head>
<body>
Playground
<script type="module">
    const memory = new WebAssembly.Memory({ initial: 10000 });
    const { instance } = await WebAssembly.instantiateStreaming(fetch('build/optimized.wasm'), { env: { memory } });
    const { buffer } = memory;
    const wasm = instance.exports;

    const w = 8;
    const h = 4;
    const inputPtr = 0;
    const size = w * h;
    const outputPtr = size * 1.5;
    const input = new Uint8Array(buffer, inputPtr, size * 1.5);

    for(let i = 0; i < size * 1.5; i++) {
        input[i] = i % 256;
    }

    const output = new Float32Array(buffer, outputPtr, size * 3);
    window.w = {
        input,
        output,
        outputPtr,
        w, h,
        inputPtr,
        size,
        wasm,
        buffer
    }

    console.log(window.w);

</script>
</body>
</html>
